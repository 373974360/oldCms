<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="searchInfo">
    <sql id="getYjcpzsList_sql_conn">
        where status != '-1'
        <if test="keyword != null">
            and ( cyrmc like '%${keyword}%' or dz like '%${keyword}%' or jdmc like '%${keyword}%' or cpmc like '%${keyword}%' or cpms like '%${keyword}%' or scgm like '%${keyword}%')
        </if>
        <if test="cyrmc != null">
            and cyrmc like '%${cyrmc}%'
        </if>
        <if test="dz != null">
            and dz like '%${dz}%'
        </if>
        <if test="jdmc != null">
            and jdmc like '%${jdmc}%'
        </if>
        <if test="jddz != null">
            and jddz like '%${jddz}%'
        </if>
        <if test="mj != null">
            and mj like '%${mj}%'
        </if>
        <if test="cpmc != null">
            and cpmc like '%${cpmc}%'
        </if>
        <if test="cpms != null">
            and cpms like '%${cpms}%'
        </if>
        <if test="scgm != null">
            and scgm like '%${scgm}%'
        </if>
        <if test="cl != null">
            and cl like '%${cl}%'
        </if>
        <if test="ccfzrq != null">
            and ccfzrq like '%${ccfzrq}%'
        </if>
        <if test="bcfzrq != null">
            and bcfzrq like '%${bcfzrq}%'
        </if>
        <if test="yxqx != null">
            and yxqx like '%${yxqx}%'
        </if>
        <if test="status != null">
            and status = #{status}
        </if>
    </sql>

    <select id="getAllYjcpzs" resultType="com.deya.project.searchInfo.YjcpzsBean" >
        select id,cyrmc,dz,jdmc,jddz,mj,cpmc,cpms,scgm,cl,ccfzrq,bcfzrq,yxqx,bz,addTime,status from dz_yjcpzs where status != '-1' order by id desc
    </select>

    <select id="getYjcpzsCount" parameterType="Map" resultType="java.lang.String" >
        select count(id) from dz_yjcpzs
        <include refid="getYjcpzsList_sql_conn"/>
    </select>

    <select id="getYjcpzsList" parameterType="Map" resultType="com.deya.project.searchInfo.YjcpzsBean" >
        select * jddzom (
        select row_.*, rownum rownum_ jddzom (
        select id,cyrmc,dz,jdmc,jddz,mj,cpmc,cpms,scgm,cl,ccfzrq,bcfzrq,yxqx,bz,addTime,status from dz_yjcpzs <include refid="getYjcpzsList_sql_conn"/>
        order by ${orderby}
        <![CDATA[
		        ) row_ where rownum <=#{page_size,,jdbcType=INTEGER}+#{start_num,,jdbcType=INTEGER}
	    	) where rownum_ >=#{start_num,,jdbcType=INTEGER} + 1
	    ]]>
    </select>

    <select id="getYjcpzsList_mysql" parameterType="Map" resultType="com.deya.project.searchInfo.YjcpzsBean" >
        select id,cyrmc,dz,jdmc,jddz,mj,cpmc,cpms,scgm,cl,ccfzrq,bcfzrq,yxqx,bz,addTime,status from dz_yjcpzs <include refid="getYjcpzsList_sql_conn"/>
        order by ${orderby} limit #{start_num,,jdbcType=INTEGER},#{page_size,,jdbcType=INTEGER}
    </select>

    <select id="getYjcpzsList_mssql" parameterType="Map" resultType="com.deya.project.searchInfo.YjcpzsBean" >
        select top #{page_size} id,cyrmc,dz,jdmc,jddz,mj,cpmc,cpms,scgm,cl,ccfzrq,bcfzrq,yxqx,bz,addTime,status
        from dz_yjcpzs
        <include refid="getYjcpzsList_sql_conn"/>
        and id not in
        (select top #{start_num} id
        from dz_yjcpzs
        <include refid="getYjcpzsList_sql_conn"/>
        order by ${orderby} )
        order by ${orderby}
    </select>

    <select id="getYjcpzsBean"  parameterType="Map" resultType="com.deya.project.searchInfo.YjcpzsBean" >
        select id,cyrmc,dz,jdmc,jddz,mj,cpmc,cpms,scgm,cl,ccfzrq,bcfzrq,yxqx,bz,addTime,status from dz_yjcpzs where id=#{id}
    </select>

    <insert id="insertYjcpzs" parameterType="com.deya.project.searchInfo.YjcpzsBean">
        insert into dz_yjcpzs(
        id,
        cyrmc,
        dz,
        jdmc,
        jddz,
        mj,
        cpmc,
        cpms,
        scgm,
        cl,
        ccfzrq,
        bcfzrq,
        yxqx,
        bz,
        addTime,
        status
        ) values(
        #{id},
        #{cyrmc},
        #{dz},
        #{jdmc},
        #{jddz},
        #{mj},
        #{cpmc},
        #{cpms},
        #{scgm},
        #{cl},
        #{ccfzrq},
        #{bcfzrq},
        #{yxqx},
        #{bz},
        #{addTime},
        #{status}
        )
    </insert>

    <update id="updateYjcpzs"  parameterType="com.deya.project.searchInfo.YjcpzsBean">
        update dz_yjcpzs set
        cyrmc=#{cyrmc},
        dz=#{dz},
        jdmc=#{jdmc},
        jddz=#{jddz},
        mj=#{mj},
        cpmc=#{cpmc},
        cpms=#{cpms},
        scgm=#{scgm},
        cl=#{cl},
        ccfzrq=#{ccfzrq},
        bcfzrq=#{bcfzrq},
        yxqx=#{yxqx},
        bz=#{bz},
        addTime=#{addTime},
        status=#{status}
        where id=#{id}
    </update>

    <update id="changeYjcpzsStatus" parameterType="Map" >
        update dz_yjcpzs set status = #{status}  where id in (${ids})
    </update>

    <update id="deleteYjcpzs" parameterType="Map" >
        update dz_yjcpzs set status = '-1' where id in (${ids})
    </update>

</mapper>