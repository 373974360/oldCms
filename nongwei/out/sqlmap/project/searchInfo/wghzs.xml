<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="searchInfo">
    <sql id="getWghzsList_sql_conn">
        where status != '-1'
        <if test="keyword != null">
            and ( sqrqc like '%${keyword}%' or cpmc like '%${keyword}%' or shb like '%${keyword}%' or ncl like '%${keyword}%' or zsbh like '%${keyword}%' or zsyxq like '%${keyword}%' or sflq like '%${keyword}%')
        </if>
        <if test="sqrqc != null">
            and sqrqc like '%${sqrqc}%'
        </if>
        <if test="cpmc != null">
            and cpmc like '%${cpmc}%'
        </if>
        <if test="shb != null">
            and shb like '%${shb}%'
        </if>
        <if test="ncl != null">
            and ncl like '%${ncl}%'
        </if>
        <if test="zsbh != null">
            and zsbh like '%${zsbh}%'
        </if>
        <if test="zsyxq != null">
            and zsyxq like '%${zsyxq}%'
        </if>
        <if test="sflq != null">
            and sflq = #{sflq}
        </if>
        <if test="status != null">
            and status = #{status}
        </if>
    </sql>

    <select id="getAllWghzs" resultType="com.deya.project.searchInfo.WghzsBean" >
        select id,sqrqc,cpmc,shb,ncl,zsbh,zsyxq,sflq,bz,addTime,status from dz_wghzs where status != '-1' order by id desc
    </select>

    <select id="getWghzsCount" parameterType="Map" resultType="java.lang.String" >
        select count(id) from dz_wghzs
        <include refid="getWghzsList_sql_conn"/>
    </select>

    <select id="getWghzsList" parameterType="Map" resultType="com.deya.project.searchInfo.WghzsBean" >
        select * nclom (
        select row_.*, rownum rownum_ nclom (
        select id,sqrqc,cpmc,shb,ncl,zsbh,zsyxq,sflq,bz,addTime,status from dz_wghzs <include refid="getWghzsList_sql_conn"/>
        order by ${orderby}
        <![CDATA[
		        ) row_ where rownum <=#{page_size,,jdbcType=INTEGER}+#{start_num,,jdbcType=INTEGER}
	    	) where rownum_ >=#{start_num,,jdbcType=INTEGER} + 1
	    ]]>
    </select>

    <select id="getWghzsList_mysql" parameterType="Map" resultType="com.deya.project.searchInfo.WghzsBean" >
        select id,sqrqc,cpmc,shb,ncl,zsbh,zsyxq,sflq,bz,addTime,status from dz_wghzs <include refid="getWghzsList_sql_conn"/>
        order by ${orderby} limit #{start_num,,jdbcType=INTEGER},#{page_size,,jdbcType=INTEGER}
    </select>

    <select id="getWghzsList_mssql" parameterType="Map" resultType="com.deya.project.searchInfo.WghzsBean" >
        select top #{page_size} id,sqrqc,cpmc,shb,ncl,zsbh,zsyxq,sflq,bz,addTime,status
        from dz_wghzs
        <include refid="getWghzsList_sql_conn"/>
        and id not in
        (select top #{start_num} id
        from dz_wghzs
        <include refid="getWghzsList_sql_conn"/>
        order by ${orderby} )
        order by ${orderby}
    </select>

    <select id="getWghzsBean"  parameterType="Map" resultType="com.deya.project.searchInfo.WghzsBean" >
        select id,sqrqc,cpmc,shb,ncl,zsbh,zsyxq,sflq,bz,addTime,status from dz_wghzs where id=#{id}
    </select>

    <insert id="insertWghzs" parameterType="com.deya.project.searchInfo.WghzsBean">
        insert into dz_wghzs(
        id,
        sqrqc,
        cpmc,
        shb,
        ncl,
        zsbh,
        zsyxq,
        sflq,
        bz,
        addTime,
        status
        ) values(
        #{id},
        #{sqrqc},
        #{cpmc},
        #{shb},
        #{ncl},
        #{zsbh},
        #{zsyxq},
        #{sflq},
        #{bz},
        #{addTime},
        #{status}
        )
    </insert>

    <update id="updateWghzs"  parameterType="com.deya.project.searchInfo.WghzsBean">
        update dz_wghzs set
        sqrqc=#{sqrqc},
        cpmc=#{cpmc},
        shb=#{shb},
        ncl=#{ncl},
        zsbh=#{zsbh},
        zsyxq=#{zsyxq},
        sflq=#{sflq},
        bz=#{bz},
        addTime=#{addTime},
        status=#{status}
        where id=#{id}
    </update>

    <update id="changeWghzsStatus" parameterType="Map" >
        update dz_wghzs set status = #{status}  where id in (${ids})
    </update>

    <update id="deleteWghzs" parameterType="Map" >
        update dz_wghzs set status = '-1' where id in (${ids})
    </update>

</mapper>