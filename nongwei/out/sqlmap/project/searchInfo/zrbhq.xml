<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="searchInfo">
    <sql id="getZrbhqList_sql_conn">
        where status != '-1'
        <if test="keyword != null">
            and ( bhqmc like '%${keyword}%' or jb like '%${keyword}%' or wz like '%${keyword}%' or jj like '%${keyword}%' or lxdh like '%${keyword}%' or txdz like '%${keyword}%')
        </if>
        <if test="bhqmc != null">
            and bhqmc like '%${bhqmc}%'
        </if>
        <if test="jb != null">
            and jb like '%${jb}%'
        </if>
        <if test="wz != null">
            and wz like '%${wz}%'
        </if>
        <if test="mj != null">
            and mj like '%${mj}%'
        </if>
        <if test="jj != null">
            and jj like '%${jj}%'
        </if>
        <if test="lxdh != null">
            and lxdh like '%${lxdh}%'
        </if>
        <if test="txdz != null">
            and txdz like '%${txdz}%'
        </if>
        <if test="yb != null">
            and yb like '%${yb}%'
        </if>
        <if test="status != null">
            and status = #{status}
        </if>
    </sql>

    <select id="getAllZrbhq" resultType="com.deya.project.searchInfo.ZrbhqBean" >
        select id,bhqmc,jb,wz,mj,jj,lxdh,txdz,yb,bz,addTime,status from dz_zrbhq where status != '-1' order by id desc
    </select>

    <select id="getZrbhqCount" parameterType="Map" resultType="java.lang.String" >
        select count(id) from dz_zrbhq
        <include refid="getZrbhqList_sql_conn"/>
    </select>

    <select id="getZrbhqList" parameterType="Map" resultType="com.deya.project.searchInfo.ZrbhqBean" >
        select * mjom (
        select row_.*, rownum rownum_ mjom (
        select id,bhqmc,jb,wz,mj,jj,lxdh,txdz,yb,bz,addTime,status from dz_zrbhq <include refid="getZrbhqList_sql_conn"/>
        order by ${orderby}
        <![CDATA[
		        ) row_ where rownum <=#{page_size,,jdbcType=INTEGER}+#{start_num,,jdbcType=INTEGER}
	    	) where rownum_ >=#{start_num,,jdbcType=INTEGER} + 1
	    ]]>
    </select>

    <select id="getZrbhqList_mysql" parameterType="Map" resultType="com.deya.project.searchInfo.ZrbhqBean" >
        select id,bhqmc,jb,wz,mj,jj,lxdh,txdz,yb,bz,addTime,status from dz_zrbhq <include refid="getZrbhqList_sql_conn"/>
        order by ${orderby} limit #{start_num,,jdbcType=INTEGER},#{page_size,,jdbcType=INTEGER}
    </select>

    <select id="getZrbhqList_mssql" parameterType="Map" resultType="com.deya.project.searchInfo.ZrbhqBean" >
        select top #{page_size} id,bhqmc,jb,wz,mj,jj,lxdh,txdz,yb,bz,addTime,status
        from dz_zrbhq
        <include refid="getZrbhqList_sql_conn"/>
        and id not in
        (select top #{start_num} id
        from dz_zrbhq
        <include refid="getZrbhqList_sql_conn"/>
        order by ${orderby} )
        order by ${orderby}
    </select>

    <select id="getZrbhqBean"  parameterType="Map" resultType="com.deya.project.searchInfo.ZrbhqBean" >
        select id,bhqmc,jb,wz,mj,jj,lxdh,txdz,yb,bz,addTime,status from dz_zrbhq where id=#{id}
    </select>

    <insert id="insertZrbhq" parameterType="com.deya.project.searchInfo.ZrbhqBean">
        insert into dz_zrbhq(
        id,
        bhqmc,
        jb,
        wz,
        mj,
        jj,
        lxdh,
        txdz,
        yb,
        bz,
        addTime,
        status
        ) values(
        #{id},
        #{bhqmc},
        #{jb},
        #{wz},
        #{mj},
        #{jj},
        #{lxdh},

        #{txdz},
        #{yb},
        #{bz},
        #{addTime},
        #{status}
        )
    </insert>

    <update id="updateZrbhq"  parameterType="com.deya.project.searchInfo.ZrbhqBean">
        update dz_zrbhq set
        bhqmc=#{bhqmc},
        jb=#{jb},
        wz=#{wz},
        mj=#{mj},
        jj=#{jj},
        lxdh=#{lxdh},
        txdz=#{txdz},
        yb=#{yb},
        bz=#{bz},
        addTime=#{addTime},
        status=#{status}
        where id=#{id}
    </update>

    <update id="changeZrbhqStatus" parameterType="Map" >
        update dz_zrbhq set status = #{status}  where id in (${ids})
    </update>

    <update id="deleteZrbhq" parameterType="Map" >
        update dz_zrbhq set status = '-1' where id in (${ids})
    </update>

</mapper>